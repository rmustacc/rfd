<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<title>
MAC_CAPAB_LED(9E)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">MAC_CAPAB_LED</b>, <b class="name">mac_capab_led</b>, <b class="name">mac_capab_led_t</b>, <b class="name">mcl_set</b> &#8212; <span class="desc">MAC LED capability</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">sys/mac_provider.h</a>&gt;</b><div class="spacer">
</div>
<span class="type">typedef struct mac_capab_led mac_capab_led_t;</span><br/>
<span class="type">typedef enum mac_led_mode mac_led_mode_t;</span><div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">mcl_set</b>(<i class="farg">void *driver</i>, <i class="farg">mac_led_mode_t mode</i>, <i class="farg">uint_t flags</i>);</div>
<div class="section">
<h1 id="x494e54455246414345204c4556454c">INTERFACE LEVEL</h1> <span class="symb">Evolving -</span> This interface is evolving still in illumos. API and ABI stability is not guaranteed.</div>
<div class="section">
<h1 id="x504152414d4554455253">PARAMETERS</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="farg">driver</i></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
A pointer to the driver's private data that was passed in via the <span class="symb">m_pdata</span> member of the <a class="link-man">mac_register(9S)</a> structure to the <a class="link-man">mac_register(9F)</a> function.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="farg">mode</i></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
A value that indicates how the driver should drive the LEDs.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="farg">flags</i></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Reserved for future use. <i class="link-sec"><a class="link-sec" href="#x4c4544204d6f646573">LED Modes</a></i>.</dd>
</dl>
</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <span class="symb">MAC_CAPAB_LED</span> provides a means for GLDv3 device drivers to change the behavior of the LEDs, allowing an administrator to change the behavior for the purpose of better finding and identifying a physical device.<div class="spacer">
</div>
Implementing this capability is optional. For more information on how to handle capabilities and how to indicate that a capability is not supported, see <a class="link-man">mc_getcapab(9E)</a>.<div class="spacer">
</div>
This capability should be implemented if the device in question provides a way to manipulate its LEDs. Generally the LEDs on a device default to indicating link status and activity. However, they can often be turned off or set to a specific pattern to indicate identification purposes.<div class="subsection">
<h2 id="x4c4544204d4f444553">LED MODES</h2> The system has a notion of different LED modes. Each LED mode suggests a different way that a device driver should drive the indicator LEDs on the device. While we generally want all such LED modes to be as uniform as possible, there is a limit to such similarities due to the capabilities of NICs. Each mode is a member of the <span class="type">mac_led_mode_t</span> enumeration. The currently defined modes are:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 6.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">MAC_LED_DEFAULT</span></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
This mode indicates that the device's default behavior should be used. This is usually some form of link status and activity. It is device specific and usually is the default behavior after a device is powered on.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">MAC_LED_OFF</span></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
This mode indicates that the device's LEDs should be turned off and not emit any light.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">MAC_LED_IDENT</span></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
This mode indicates that the driver should emit some form of identication pattern. We suggest that devices indicate some form of solid blinking light that is on and off at alternating units of time. If it is possible to use an alternate color from the normal link up and activity lighting, that is recommended.</dd>
</dl>
</div>
<div class="subsection">
<h2 id="x4d4143204361706162696c69747920537472756374757265">MAC Capability Structure</h2> When the device driver's <a class="link-man">mc_getcapab(9E)</a> function entry point is called with the capability set to <span class="define">MAC_CAPAB_LED</span>, then the value of the capability structure is the following structure:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
typedef struct mac_capab_led { 
	uint_t		mcl_flags; 
	mac_led_mode_t	mcl_modes; 
	int		(*mcl_set)(void *driver, mac_led_mode_t mode, 
			    uint_t flags); 
} mac_capab_led_t;</pre>
<div class="spacer">
</div>
If the driver supports the <span class="define">MAC_CAPAB_LED</span> capability, it should fill in this structure, based on the following rules:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="symb">mcl_flags</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The <span class="type">mcl_flags</span> member is used to negotiate extensions with the driver. MAC will set the value of <span class="type">mcl_flags</span> to include all of the currently known extensions. The driver should intersect this list with the set that they actually support. At this time, no such features are defined and the driver should set the member to <span class="symb">0</span>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="symb">mcl_modes</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The <span class="type">mcl_modes</span> member represents the support modes of the device driver. The device driver should set <span class="type">mcl_modes</span> to the bitwise-inclusive-OR of the LED modes listed in <i class="link-sec"><a class="link-sec" href="#x4c4544204d4f444553">LED MODES</a></i>.<div class="spacer">
</div>
If the driver does not support anything other than the default behavior of <span class="define">MAC_LED_DEFAULT</span>, then the device driver should not indicate that it supports this capability.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="symb">mcl_set</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The <i class="ftype">mct_set</i> entry point will be called by the MAC framework when it needs the device driver to change how it is driving its LEDs. Each call will ask the driver to change the display mode to the specified mode. The driver does not have to multiplex requests for multiple modes or keep track of what has been requested, that is taken care of by the system itself.<div class="spacer">
</div>
The driver should first validate that <i class="farg">mode</i> is a mode that it supports. While the device reports the set of supported modes as a bitwise-inclusive-OR, the driver should only receive a single value in <i class="farg">mode</i>. The value of the <i class="farg">flags</i> argument is reserved for future use. Drivers must check that the value of flags is zero and if not, return <span class="errno">EINVAL</span>.<div class="spacer">
</div>
When this entry point is first called on a driver, it should snapshot its device registers such that it knows how to restore the default behavior. Because each method of programming the LEDs is different, it is up to the driver itself to take care of this, the broader framework cannot take care of it.<div class="spacer">
</div>
If for some reason the driver is asked to program the same mode as it is already driving, then it need not do anything and should simply return success.<div class="spacer">
</div>
Once the driver successfully changes the LED driving mode, it should return <span class="symb">0</span>. Otherwise, it should return the appropriate error number. For a full list of error numbers, see <a class="link-man">Intro(2)</a>. Common values are:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="errno">EINVAL</span></dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
<i class="farg">mode</i> is unsupported. <i class="farg">flags</i> contains an unsupported or unknown value.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="errno">EIO</span></dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
An I/O error occurred while trying to program the device's registers. This could be because a command timed out or an FM-aware driver encountered an error.</dd>
</dl>
</dd>
</dl>
</div>
</div>
<div class="section">
<h1 id="x434f4e54455854">CONTEXT</h1> The <i class="ftype">mcl_set</i> entry point will only be called from <span class="symb">user</span> or <span class="symb">kernel</span> context. It will never be called from interrupt context.</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1></div>
</div>
</body>
</html>

